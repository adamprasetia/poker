<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Poker</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    </head>
    <body>
        <div class="container">
            <div class="jumbotron">
                <h1>KGPoker</h1>
                <div class="form-group">
                    <label for="">Username</label>
                    <input id="username" type="text" name="" value="" class="form-control">
                </div>
                <button id="btnRegister" type="button" name="button" class="btn btn-primary">Register</button>
            </div>
        </div>
        <script type="text/javascript" src="http://code.jquery.com/jquery-3.3.1.min.js"></script>        
        <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
        <script src="assets/js/config.js"></script>
        <script src="assets/js/helper.js"></script>
        <script type="text/javascript">
            if (getCookie('userlogin')) {
                window.location = 'play.html';
            }
            $('#btnRegister').click(function(){
                if ($('#username').val()) {
                    firebase.database().ref('games').once('value').then(function(response){
                        var id = 0;
                        if (response.val() && response.val().player && response.val().player.length > 0) {
                            // swal("Oops", "Username is existing!", "error");
                            id = response.val().player.length;
                        }
                        firebase.database().ref('games/player/'+id).set({
                            name:$('#username').val()
                        }).then(function(){
                            setCookie("userlogin", JSON.stringify({'id':id,'username':$('#username').val()}), 365);
                            swal("Success", "Welcome, "+$('#username').val()+" and enjoy the game", "success");
                            window.location = 'play.html';
                            // resetGame();                            
                        });
                    });
                }else{
                    swal("Oops", "Username is required!" , "error");
                }
            });
        </script>
    </body>
</html>